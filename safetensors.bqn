lib â† â€¢args â€¢file.At "bqn_safetensors"{
    ğ•¨ğ•Š"windows": ğ•¨âˆ¾".dll"; 
    "lib"âˆ¾ğ•¨âˆ¾".so"
}â€¢platform.os

("'"âˆ¾libâˆ¾"' not found") ! â€¢file.Exists lib

ffi â† {
    serialize â‡ lib â€¢FFI "a"â€¿"serialize"â€¿"a"â€¿"a"â€¿"a"
    getNames â‡ lib â€¢FFI "a"â€¿"get_names"â€¿"a"
    getTensor â‡ lib â€¢FFI "a"â€¿"get_tensor"â€¿"a"â€¿"a"
}

SaveFile â‡ {ğ•¨ğ•Šx:
    kâ€¿v â† {
    0: <Ë˜â‰x ;
    6: âŸ¨x.Keys @, x.Values @âŸ© ;
        !"Wrong type for argument ğ•©"
    }â€¢Type x
    k â€¢ToUTF8Â¨â†©
    b â† 0=â€¢internal.ElTypeÂ¨v
    v "Ai8"âŠ¸â€¢internal.VariationÂ¨âŒ¾(bâŠ¸/) â†©
    âŸ¨ok,râŸ© â† ffi.Serialize âŸ¨â€¢ToUTF8 ğ•¨,k,vâŸ©
    {okâ‰¡0? !r ; r}
}

LoadFile â‡ {ğ•Šfile:
    file (â€¢ToUTF8 â€¢file.RealPath)â†©
    âŸ¨ok,râŸ© â† ffi.GetNames âŸ¨fileâŸ©
    {okâ‰¡0? !r ;
        {
            dict â† r â€¢HashMap @Â¨r
            file â† file
            Get â‡ {ğ•Šk:
                v â† dict.Get k
                {vâ‰¢@? v ;
                    âŸ¨ok,râŸ© â† ffi.GetTensorâŸ¨file,â€¢ToUTF8 kâŸ©
                    {okâ‰¡0? !r ; râŠ£k dict.Set r}
                }
            }
            Has â‡ dict.Has
            Keys â‡ dict.Keys
            Values â‡ GetÂ¨Keys
            Count â‡ dict.Count
        }
    }
}
